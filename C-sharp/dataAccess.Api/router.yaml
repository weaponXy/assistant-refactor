# router.yaml
# Format matches RouterConfig class: intents[] and domains[] arrays
# Each rule has: id, any[], not[], weight (optional), threshold (optional)
# Patterns support:
#   - Plain text: "forecast"
#   - Regex: "regex:/(?i)\\bforecast\\b/"

intent_fallback: "nlq"
domain_fallback: "sales"

# ==========================
# INTENTS (forecasting, report, nlq, chitchat, faq)
# ==========================
intents:
  # FAQ: highest priority for help/support questions (weight 12)
  - id: "faq"
    weight: 12.0
    # Lower the threshold so partial matches and common phrasings trigger FAQ
    threshold: 0.5
    any:
      # English: how-to, help, support, FAQ keywords
      - "regex:/(?i)\\b(how\\s+(do|to|can|does)|help|support|guide|tutorial|faq|frequently\\s+asked)\\b/"
      - "regex:/(?i)\\b(what\\s+is|explain|tell\\s+me\\s+about)\\b.*\\b(feature|system|function|refund|policy|account|password|login)\\b/"
      # Questions about accuracy, reliability, methodology
      - "regex:/(?i)\\b(how\\s+(accurate|reliable)|what\\s+is\\s+the\\s+(accuracy|reliability|method))\\b/"
      - "regex:/(?i)\\b(gaano\\s+ka(accurate|tumpak))\\b/"
      # Tagalog: paano, tulong, gabay
      - "regex:/(?i)\\b(paano|tulong|gabay|support|help)\\b/"
      # common account/support keywords (password, reset)
      - "regex:/(?i)\\b(password|reset\\s+password|change\\s+password|forgot\\s+password)\\b/"
      - "regex:/(?i)\\b(ano\\s+ang|ipaliwanag|sabihin\\s+mo)\\b.*\\b(feature|system|password|account|refund|policy)\\b/"

  # Forecasting: highest priority (weight 10)
  - id: "forecasting"
    weight: 10.0
    threshold: 1.0
    any:
      # English: forecast/predict/projection + sales/expenses/revenue
      - "regex:/(?i)\\b(forecast|predict(ion)?|projection|project)\\b.*\\b(sales|revenue|expense|expenses|spend(ing)?)\\b/"
      # English: next week/month/days
      - "regex:/(?i)\\b(sales|revenue|expense|expenses)\\b.*\\b(next\\s+(week|month|quarter)|\\d+\\s*days?)\\b/"
      # Tagalog
      - "regex:/(?i)\\b(predict|forecast)\\b.*\\b(benta|kita|gastos)\\b/"
      - "regex:/(?i)\\b(benta|kita|gastos)\\b.*\\b(susunod|\\d+\\s*araw)\\b/"

  # Report: medium-high priority (weight 8)
  - id: "report"
    weight: 8.0
    threshold: 1.0
    any:
      # English: explicit report requests
      - "regex:/(?i)\\b(create|generate|make|build|prepare|show\\s+me)\\b.*\\breport\\b/"
      - "regex:/(?i)\\breport\\b.*\\b(sales|revenue|expense|expenses|inventory|stock)\\b/"
      # Tagalog
      - "regex:/(?i)\\b(gawan|gawa|gumawa|ihanda)\\b.*\\b(ulat|report)\\b/"
    not:
      # Exclude HOW-TO questions - those are FAQ
      - "regex:/(?i)\\b(how\\s+(do|to|can|does))\\b/"
      - "regex:/(?i)\\b(paano)\\b/"
      # Exclude if contains forecast keywords
      - "regex:/(?i)\\b(forecast|predict|projection|next\\s+(week|month)|\\d+\\s*days?)\\b/"

  # NLQ: medium priority (weight 5)
  - id: "nlq"
    weight: 5.0
    threshold: 1.0
    any:
      # Question words
      - "regex:/(?i)\\b(what|which|who|how\\s+(many|much)|when|where|compare|top|best|list|show|filter|find)\\b/"
      - "regex:/(?i)\\b(sum|total|average|avg|max|min|count)\\b/"
      # Tagalog
      - "regex:/(?i)\\b(ilan|magkano|kailan|ano|alin|ipakita|ilist|ihambing)\\b/"
    not:
      - "regex:/(?i)\\b(forecast|predict|report)\\b/"

  # Chitchat: low priority (weight 2)
  - id: "chitchat"
    weight: 2.0
    threshold: 1.0
    any:
      - "regex:/(?i)\\b(hi|hello|hey|kumusta|kamusta|good\\s+(morning|evening|afternoon)|thanks?|thank\\s+you|salamat)\\b/"
      - "regex:/(?i)\\b(joke|kwento|story|chitchat|usap)\\b/"

# ==========================
# DOMAINS (sales, expenses, inventory)
# ==========================
domains:
  - id: "sales"
    weight: 1.0
    threshold: 1.0
    any:
      - "regex:/(?i)\\b(sales?|revenue|benta|kita|order|transaction)\\b/"
  
  - id: "expenses"
    weight: 1.0
    threshold: 1.0
    any:
      - "regex:/(?i)\\b(expense|expenses|spend(ing)?|cost|gastos)\\b/"
  
  - id: "inventory"
    weight: 1.0
    threshold: 1.0
    any:
      - "regex:/(?i)\\b(inventory|stock|stocks|product|imbentaryo)\\b/"
